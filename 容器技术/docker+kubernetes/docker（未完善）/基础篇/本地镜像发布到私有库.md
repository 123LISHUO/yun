# æœ¬åœ°é•œåƒå‘å¸ƒåˆ°ç§æœ‰åº“

## æœ¬åœ°é•œåƒå‘å¸ƒåˆ°ç§æœ‰åº“æµç¨‹

![1669740943987](image/æœ¬åœ°é•œåƒå‘å¸ƒåˆ°ç§æœ‰åº“/1669740943987.png)

## æ˜¯ä»€ä¹ˆ

1ã€å®˜æ–¹Docker Hubåœ°å€ï¼šhttps://hub.docker.com/ï¼Œä¸­å›½å¤§é™†è®¿é—®å¤ªæ…¢äº†ä¸”å‡†å¤‡è¢«é˜¿é‡Œäº‘å–ä»£çš„è¶‹åŠ¿ï¼Œä¸å¤ªä¸»æµã€‚

2ã€Dockerhubã€é˜¿é‡Œäº‘è¿™æ ·çš„å…¬å…±é•œåƒä»“åº“å¯èƒ½ä¸å¤ªæ–¹ä¾¿ï¼Œæ¶‰åŠæœºå¯†çš„å…¬å¸ä¸å¯èƒ½æä¾›é•œåƒç»™å…¬ç½‘ï¼Œæ‰€ä»¥éœ€è¦åˆ›å»ºä¸€ä¸ªæœ¬åœ°ç§äººä»“åº“ä¾›ç»™å›¢é˜Ÿä½¿ç”¨ï¼ŒåŸºäºå…¬å¸å†…éƒ¨é¡¹ç›®æ„å»ºé•œåƒã€‚

â­ï¸Docker Registryæ˜¯å®˜æ–¹æä¾›çš„å·¥å…·ï¼Œå¯ä»¥ç”¨äºæ„å»ºç§æœ‰é•œåƒä»“åº“

## ğŸ³åˆ›å»ºç§æœ‰åº“&&å°†æœ¬åœ°é•œåƒæ¨é€åˆ°ç§æœ‰åº“

1ã€ä¸‹è½½é•œåƒDocker Registry

```python
    docker pull registry
```

2ã€è¿è¡Œç§æœ‰åº“Registryï¼Œç›¸å½“äºæœ¬åœ°æœ‰ä¸ªç§æœ‰çš„Docker Hub

```python
docker run -d -p 5000:5000  -v /zzyyuse/myregistry/:/tmp/registry --privileged=true registry

é»˜è®¤æƒ…å†µï¼Œä»“åº“è¢«åˆ›å»ºåœ¨å®¹å™¨çš„/var/lib/registryç›®å½•ä¸‹ï¼Œå»ºè®®è‡ªè¡Œç”¨å®¹å™¨å·æ˜ å°„ï¼Œæ–¹ä¾¿äºå®¿ä¸»æœºè”è°ƒ

ä½¿ç”¨å®˜æ–¹çš„ registry é•œåƒæ¥å¯åŠ¨ç§æœ‰ä»“åº“ã€‚é˜³å“¥å¯åŠ¨å®¹å™¨çš„å‘½ä»¤é‡Œç»‘å®šæ•°æ®å·é‚£é‡Œå†™çš„`/tmp/registry`ã€‚å®æµ‹æœ¬åœ°é•œåƒpushåˆ°ç§æœåº“ä¹‹åï¼Œè¿™ä¸ªè·¯å¾„ä¸‹æ²¡æœ‰é•œåƒã€‚æŸ¥äº†ä¸‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä»“åº“ä¼šè¢«åˆ›å»ºåœ¨å®¹å™¨çš„ `/var/lib/registry` ç›®å½•ä¸‹ã€‚
```

3ã€å‡†å¤‡ä¸€ä¸ªé•œåƒæ–‡ä»¶ï¼Œæˆ‘å‡†å¤‡ä¸ºcentos/vim
``ä¹‹å‰å¼„è¿‡ï¼Œè¿™é‡Œå°±ä¸å¼„äº†``

4ã€curléªŒè¯ç§æœåº“ä¸Šæœ‰ä»€ä¹ˆé•œåƒï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥åœ¨ç½‘é¡µä¸Šè¿›è¡ŒæŸ¥çœ‹ï¼Œä¸è¿‡éœ€è¦ä¸‹è½½httpdï¼‰

```python
[root@localhost ~]# curl -XGET http://192.168.100.123:5000/v2/_catalog
{"repositories":[]}

v2/_catalogæ˜¯ä¸€ä¸ªé»˜è®¤è·¯å¾„
å¯ä»¥çœ‹åˆ°ï¼Œç›®å‰ç§æœåº“æ²¡æœ‰ä»»ä½•é•œåƒä¸Šä¼ è¿‡ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
```

5ã€å°†é•œåƒcentos/vimä¿®æ”¹ç¬¦åˆç§æœè§„èŒƒçš„Tag

```python
æŒ‰ç…§å…¬å¼ï¼šÂ docker   tag   é•œåƒ:Tag   Host:Port/Repository:Tag

è‡ªå·±hostä¸»æœºIPåœ°å€ï¼Œå¡«å†™åŒå­¦ä½ ä»¬è‡ªå·±çš„ï¼Œä¸è¦ç²˜è´´é”™è¯¯ï¼ŒO(âˆ©_âˆ©)O

ä½¿ç”¨å‘½ä»¤ docker tag å°†zzyyubuntu:1.2 è¿™ä¸ªé•œåƒä¿®æ”¹ä¸º192.168.111.162:5000/zzyyubuntu:1.2

docker tag  centos/vim:7.5.1804  192.168.100.123:5000/centos/vim:7.5.1804
```

![1669743284015](image/æœ¬åœ°é•œåƒå‘å¸ƒåˆ°ç§æœ‰åº“/1669743284015.png)

6ã€ä¿®æ”¹dockeré…ç½®æ–‡ä»¶
![1669743527721](image/æœ¬åœ°é•œåƒå‘å¸ƒåˆ°ç§æœ‰åº“/1669743527721.png)

```
æ³¨æ„ï¼š

é…ç½®registryä»“åº“çš„ipåœ°å€ï¼Œå¯ä»¥æ˜¯è¿œç¨‹äº‘æœåŠ¡å™¨çš„ipåœ°å€ã€‚

åˆ«æ— è„‘ç…§ç€å¤åˆ¶ï¼Œregistry-mirrors é…ç½®çš„æ˜¯å›½å†…é˜¿é‡Œæä¾›çš„é•œåƒåŠ é€Ÿåœ°å€ï¼Œä¸ç”¨åŠ é€Ÿçš„è¯è®¿é—®å®˜ç½‘çš„ä¼šå¾ˆæ…¢ã€‚

2ä¸ªé…ç½®ä¸­é—´æœ‰ä¸ªé€—å· ','åˆ«æ¼äº†ï¼Œè¿™ä¸ªé…ç½®æ˜¯jsonæ ¼å¼çš„ã€‚
2ä¸ªé…ç½®ä¸­é—´æœ‰ä¸ªé€—å· ','åˆ«æ¼äº†ï¼Œè¿™ä¸ªé…ç½®æ˜¯jsonæ ¼å¼çš„ã€‚
2ä¸ªé…ç½®ä¸­é—´æœ‰ä¸ªé€—å· ','åˆ«æ¼äº†ï¼Œè¿™ä¸ªé…ç½®æ˜¯jsonæ ¼å¼çš„ã€‚
```

```python
vimå‘½ä»¤æ–°å¢å¦‚ä¸‹çº¢è‰²å†…å®¹ï¼švim /etc/docker/daemon.json
{
  "registry-mirrors": ["https://aa25jngu.mirror.aliyuncs.com"], 
  "insecure-registries": ["192.168.100.123:5000"]
}
```

ä¸Šè¿°ç†ç”±ï¼šdockeré»˜è®¤ä¸å…è®¸httpæ–¹å¼æ¨é€é•œåƒï¼Œé€šè¿‡é…ç½®é€‰é¡¹æ¥å–æ¶ˆè¿™ä¸ªé™åˆ¶ã€‚====>Â ä¿®æ”¹å®Œåå¦‚æœä¸ç”Ÿæ•ˆï¼Œå»ºè®®é‡å¯docker

7ã€pushæ¨é€åˆ°ç§æœåº“

```python
docker push 192.168.100.123:5000/centos/vim:7.5.1804

[root@localhost ~]# docker push 192.168.100.123:5000/centos/vim:7.5.1804
The push refers to repository [192.168.100.123:5000/centos/vim]
b823c389a505: Pushed 
4826cdadf1ef: Pushed 
7.5.1804: digest: sha256:026affc2789a17751bbb87d4e396e8511832625d9a09742417b28cf68ef13dfc size: 742
```

8ã€curléªŒè¯ç§æœåº“ä¸Šæœ‰ä»€ä¹ˆé•œåƒï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥åœ¨ç½‘é¡µä¸Šè¿›è¡ŒæŸ¥çœ‹ï¼Œä¸è¿‡éœ€è¦ä¸‹è½½httpdï¼‰

```python
curl -XGET http://192.168.100.123:5000/v2/_catalog

[root@localhost ~]# curl -XGET http://192.168.100.123:5000/v2/_catalog
{"repositories":["centos/vim"]}
```

9ã€pullåˆ°æœ¬åœ°å¹¶è¿è¡Œ

```python
docker pull 192.168.100.123:5000/centos/vim:7.5.1804
```
## æ€»ç»“
registryä»…æä¾›ä¸€ä¸ªå­˜å‚¨é•œåƒçš„åœ°æ–¹ï¼Œå®ƒåªç®€å•çš„å±•ç¤ºäº†ç§æœ‰ä»“åº“çš„é•œåƒåç§°å’Œtagï¼Œæ— æ³•æŸ¥çœ‹ç§æœ‰ä»“åº“æ›´è¯¦ç»†ä¿¡æ¯ã€‚å®é™…ç”Ÿäº§ç¯å¢ƒå¾ˆå°‘ç”¨åˆ°registryç§æœ‰ä»“åº“ã€‚

## å‚è€ƒæ–‡æ¡£

[è¡€ç…é•¿è™¹](https://blog.csdn.net/succing/article/details/122757052?)